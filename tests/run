#!/bin/sh

if [ "$1" = "" ]; then
  IP=$(ip addr show wlan0|grep 'inet '|awk '{print $2}'|awk -F'/' '{print $1}')
  echo "Usages:
  run [sensor_name]
  run [test_number]

  sensor_names:
    th -> temperature_and_humidity
    fire -> infrared sensor for fire detection
    cam -> camera interface, run `vlc tcp/h264://$IP:2999` on host

  test_number:
    1 to 3 (inclusive)
"
elif [ "$1" = "th" ]; then
  echo "running temperature_and_humidity sensor"
  sudo mount --mkdir ramfs -t ramfs /tmp/ramfss
  sudo chown "$(whoami)" -R /tmp/ramfss/
  (cd ~/Project/temperature_and_humidity/ && gcc main.c -lwiringPi -o temperature_and_humidity && ./temperature_and_humidity)
elif [ "$1" = "fire" ]; then
  echo "running infrered sensor"
  (cd ~/Project/infrared/ && gcc main.c -lwiringPi -o infrared && ./infrared)
elif [ "$1" = "cam" ]; then
  sudo rpicam-vid --flicker-period=10000us --width=1920 --height=1080 -t0 -l -o tcp://0.0.0.0:2999
else
  echo "trying to run test_$1"
  (cd "$HOME/tests/difficulty_order/test_$1/" && bash run.sh $1)
fi


#include <stdio.h>
#include <wiringPi.h>
#include <stdlib.h>
#include <stdint.h>

#define PIN_IN 0
#define PIN_OUT 1
#define RESOLUTION 25


uint16_t len = 0;
uint16_t len_bak = -1;


void read_dht11_dat() {
  // if input has not changed, skip this roll
  if (1 == digitalRead(PIN_IN)) {
    delayMicroseconds(RESOLUTION);
    printf("");
  } else {
    digitalWrite(PIN_OUT, 1);
    printf("Fire Detected\n");
    delay(1500);
    digitalWrite(PIN_OUT, 0);
  }
}

int main( void ) {
  // setup gpio
  if ( wiringPiSetup() == -1 ) exit( 1 );

  // Set output to zero
  pinMode(PIN_IN, OUTPUT);
  digitalWrite(PIN_IN, 0);

  pinMode(PIN_OUT, OUTPUT);
  digitalWrite(PIN_OUT, 0);

  delayMicroseconds(1);

  // Set initial reference
  pinMode(PIN_IN, INPUT);

  delayMicroseconds(1);

  for (;;) read_dht11_dat();

  return 0;
}


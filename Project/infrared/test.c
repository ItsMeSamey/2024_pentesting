#include <wiringPi.h>
#include <stdio.h>
#include <stdlib.h>
#include <stdint.h>

#define PIN 7
#define RESOLUTION 25

#define PARRAY(arr, len) for (uint16_t __i = 0; __i < len; __i++) printw("%d", arr[__i])

uint8_t _buffer1[1024*4];
uint8_t _buffer2[1024*4];

uint8_t *arr = _buffer1;
uint8_t *arr_bak = _buffer2;
uint16_t len = 0;
uint16_t len_bak = -1;
uint8_t in;


void read_dht11_dat() {
  // if input has not changed, skip this roll
  if (in == digitalRead(PIN)) {
    delayMicroseconds(RESOLUTION);
    return;
  }
  printf("Flame Detected!\n");
}


int main( void ) {
  setbuf(stdout, NULL);
  printf( "Ir Sensor\n" );

  // setup gpio
  if ( wiringPiSetup() == -1 ) exit( 1 );
  pinMode(PIN, INPUT);
  // why delay? just in case!!
  delayMicroseconds(1);
  // need initial reference
  in = digitalRead(PIN);

  for (;;) read_dht11_dat();

  return 0;
}

